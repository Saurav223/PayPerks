from db_connector import create_connection
import hashlib



def hash_password(password):
    return hashlib.sha256(password.encode()).hexdigest()

def register_user(username,password,email):
    conn = create_connection()
    cursor = conn.cursor()
    password = hash_password(password)
    query = 'INSERT INTO users(username, password, email) VALUES(%S, %S,%S)'
    cursor.execute(query,(username,password,email))
    conn.commit()
    return True
    cursor.close()
    conn.close()

def authenticate_user(username, password):
    conn = create_connection()
    cursor = conn.cursor()
    password = hash_password(password)
    query = 'SELECT * FROM users WHERE username=%s AND password=%s'
    cursor.execute(query, (username, password))
    user = cursor.fetchone()
    cursor.close()
    conn.close()
    return user is not None
